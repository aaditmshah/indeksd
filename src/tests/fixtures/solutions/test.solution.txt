export type Value = 1 | 2 | 3;
export type Value2 = "1" | true | 0.2;
export type Value3 = Value | false;
export type Value4 = "some";
type AuthorGetArgs = string | {
    name: string;
} | {
    email: string;
};
type PostsGetArgs = {
    name: string;
};
export type MyDatabaseClient = {
    author: {
        add: (arg: Author) => Promise<void>;
    };
    posts: {
        add: (arg: Posts) => Promise<void>;
    };
};
function createDatabaseClient(db: IDBDatabase): MyDatabaseClient {
    return {
        author: {
            add: (arg: Author): Promise<void> => {
                const tx = db.transaction(["Author"], "readwrite");
                const store = tx.objectStore("Author");
                const addRequest: IDBRequest = store.add(arg);
                addRequest.onerror = event => {
                    reject(event);
                };
                addRequest.onsuccess = event => {
                    resolve();
                };
            }
        },
        posts: {
            add: (arg: Posts): Promise<void> => {
                const tx = db.transaction(["Posts"], "readwrite");
                const store = tx.objectStore("Posts");
                const addRequest: IDBRequest = store.add(arg);
                addRequest.onerror = event => {
                    reject(event);
                };
                addRequest.onsuccess = event => {
                    resolve();
                };
            }
        }
    };
}
export function init(): Promise<MyDatabaseClient> {
    return new Promise((resolve, reject) => {
        const DBOpenRequest = globalThis.open("MyDatabase");
        DBOpenRequest.onerror = event => {
            reject("Error opening database: MyDatabase");
        };
        DBOpenRequest.onsuccess = event => {
            const db = DBOpenRequest.result;
            resolve(createDatabaseClient(db));
        };
        DBOpenRequest.onupgradeneeded = event => {
            const db = DBOpenRequest.result;
            const AuthorStore = db.createObjectStore("Author", { keyPath: "id" });
            const PostsStore = db.createObjectStore("Posts", {});
            AuthorStore.createIndex("name", "name", { unique: false });
            AuthorStore.createIndex("email", "email", { unique: true });
            PostsStore.createIndex("name", "name", { unique: false });
        };
    });
}
